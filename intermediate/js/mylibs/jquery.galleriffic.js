(function(b){var d={};var a=0;b.galleriffic={version:"2.0.1",normalizeHash:function(e){return e.replace(/^.*#/,"").replace(/\?.*$/,"")},getImage:function(e){if(!e){return undefined}e=b.galleriffic.normalizeHash(e);return d[e]},gotoImage:function(f){var g=b.galleriffic.getImage(f);if(!g){return false}var e=g.gallery;e.gotoImage(g);return true},removeImageByHash:function(g,f){var h=b.galleriffic.getImage(g);if(!h){return false}var e=h.gallery;if(f&&f!=e){return false}return e.removeImageByIndex(h.index)}};var c={delay:3000,numThumbs:20,preloadAhead:40,enableTopPager:false,enableBottomPager:true,maxPagesToShow:7,imageContainerSel:"",captionContainerSel:"",controlsContainerSel:"",loadingContainerSel:"",renderSSControls:true,renderNavControls:true,playLinkText:"Play",pauseLinkText:"Pause",prevLinkText:"Previous",nextLinkText:"Next",nextPageLinkText:"Next &rsaquo;",prevPageLinkText:"&lsaquo; Prev",enableHistory:false,enableKeyboardNavigation:true,autoStart:false,syncTransitions:false,defaultTransitionDuration:1000,onSlideChange:undefined,onTransitionOut:undefined,onTransitionIn:undefined,onPageTransitionOut:undefined,onPageTransitionIn:undefined,onImageAdded:undefined,onImageRemoved:undefined};b.fn.galleriffic=function(g){b.extend(this,{version:b.galleriffic.version,isSlideshowRunning:false,slideshowTimeout:undefined,clickHandler:function(m,k){this.pause();if(!this.enableHistory){var l=b.galleriffic.normalizeHash(b(k).attr("href"));b.galleriffic.gotoImage(l);m.preventDefault()}},appendImage:function(k){this.addImage(k,false,false);return this},insertImage:function(l,k){this.addImage(l,false,true,k);return this},addImage:function(l,q,u,r){var s=(typeof l==="string")?b(l):l;var m=s.find("a.thumb");var n=m.attr("href");var t=m.attr("title");var p=s.find(".caption").remove();var o=m.attr("name");a++;if(!o||d[""+o]){o=a}if(!u){r=this.data.length}var k={title:t,slideUrl:n,caption:p,hash:o,gallery:this,index:r};if(u){this.data.splice(r,0,k);this.updateIndices(r)}else{this.data.push(k)}var v=this;if(!q){this.updateThumbs(function(){var w=v.find("ul.thumbs");if(u){w.children(":eq("+r+")").before(s)}else{w.append(s)}if(v.onImageAdded){v.onImageAdded(k,s)}})}d[""+o]=k;m.attr("rel","history").attr("href","#"+o).removeAttr("name").click(function(w){v.clickHandler(w,this)});return this},removeImageByIndex:function(k){if(k<0||k>=this.data.length){return false}var l=this.data[k];if(!l){return false}this.removeImage(l);return true},removeImageByHash:function(k){return b.galleriffic.removeImageByHash(k,this)},removeImage:function(l){var k=l.index;this.data.splice(k,1);delete d[""+l.hash];this.updateThumbs(function(){var m=e.find("ul.thumbs").children(":eq("+k+")").remove();if(e.onImageRemoved){e.onImageRemoved(l,m)}});this.updateIndices(k);return this},updateIndices:function(k){for(i=k;i<this.data.length;i++){this.data[i].index=i}return this},initializeThumbs:function(){this.data=[];var k=this;this.find("ul.thumbs > li").each(function(l){k.addImage(b(this),true,false)});return this},isPreloadComplete:false,preloadInit:function(){if(this.preloadAhead==0){return this}this.preloadStartIndex=this.currentImage.index;var k=this.getNextIndex(this.preloadStartIndex);return this.preloadRecursive(this.preloadStartIndex,k)},preloadRelocate:function(k){this.preloadStartIndex=k;return this},preloadRecursive:function(p,m){if(p!=this.preloadStartIndex){var k=this.getNextIndex(this.preloadStartIndex);return this.preloadRecursive(this.preloadStartIndex,k)}var l=this;var n=m-p;if(n<0){n=this.data.length-1-p+m}if(this.preloadAhead>=0&&n>this.preloadAhead){setTimeout(function(){l.preloadRecursive(p,m)},500);return this}var q=this.data[m];if(!q){return this}if(q.image){return this.preloadNext(p,m)}var o=new Image();o.onload=function(){q.image=this;l.preloadNext(p,m)};o.alt=q.title;o.src=q.slideUrl;return this},preloadNext:function(n,m){var k=this.getNextIndex(m);if(k==n){this.isPreloadComplete=true}else{var l=this;setTimeout(function(){l.preloadRecursive(n,k)},100)}return this
},getNextIndex:function(l){var k=l+1;if(k>=this.data.length){k=0}return k},getPrevIndex:function(k){var l=k-1;if(l<0){l=this.data.length-1}return l},pause:function(){this.isSlideshowRunning=false;if(this.slideshowTimeout){clearTimeout(this.slideshowTimeout);this.slideshowTimeout=undefined}if(this.$controlsContainer){this.$controlsContainer.find("div.ss-controls a").removeClass().addClass("play").attr("title",this.playLinkText).attr("href","#play").html(this.playLinkText)}return this},play:function(){this.isSlideshowRunning=true;if(this.$controlsContainer){this.$controlsContainer.find("div.ss-controls a").removeClass().addClass("pause").attr("title",this.pauseLinkText).attr("href","#pause").html(this.pauseLinkText)}if(!this.slideshowTimeout){var k=this;this.slideshowTimeout=setTimeout(function(){k.ssAdvance()},this.delay)}return this},toggleSlideshow:function(){if(this.isSlideshowRunning){this.pause()}else{this.play()}return this},ssAdvance:function(){if(this.isSlideshowRunning){this.next(true)}return this},next:function(k,l){this.gotoIndex(this.getNextIndex(this.currentImage.index),k,l);return this},previous:function(k,l){this.gotoIndex(this.getPrevIndex(this.currentImage.index),k,l);return this},nextPage:function(l,p){var n=this.getCurrentPage();var m=this.getNumPages()-1;if(n<m){var o=n*this.numThumbs;var k=o+this.numThumbs;this.gotoIndex(k,l,p)}return this},previousPage:function(k,o){var m=this.getCurrentPage();if(m>0){var n=m*this.numThumbs;var l=n-this.numThumbs;this.gotoIndex(l,k,o)}return this},gotoIndex:function(l,k,m){if(!k){this.pause()}if(l<0){l=0}else{if(l>=this.data.length){l=this.data.length-1}}var n=this.data[l];if(!m&&this.enableHistory){b.historyLoad(String(n.hash))}else{this.gotoImage(n)}return this},gotoImage:function(l){var k=l.index;if(this.onSlideChange){this.onSlideChange(this.currentImage.index,k)}this.currentImage=l;this.preloadRelocate(k);this.refresh();return this},getDefaultTransitionDuration:function(k){if(k){return this.defaultTransitionDuration}return this.defaultTransitionDuration/2},refresh:function(){var k=this.currentImage;if(!k){return this}var o=k.index;if(this.$controlsContainer){this.$controlsContainer.find("div.nav-controls a.prev").attr("href","#"+this.data[this.getPrevIndex(o)].hash).end().find("div.nav-controls a.next").attr("href","#"+this.data[this.getNextIndex(o)].hash)}var r=this.$imageContainer.find("span.current").addClass("previous").removeClass("current");var q=0;if(this.$captionContainer){q=this.$captionContainer.find("span.current").addClass("previous").removeClass("current")}var n=this.syncTransitions&&k.image;var l=true;var s=this;var p=function(){l=false;r.remove();if(q){q.remove()}if(!n){if(k.image&&k.hash==s.data[s.currentImage.index].hash){s.buildImage(k,n)}else{if(s.$loadingContainer){s.$loadingContainer.show()}}}};if(r.length==0){p()}else{if(this.onTransitionOut){this.onTransitionOut(r,q,n,p)}else{r.fadeTo(this.getDefaultTransitionDuration(n),0,p);if(q){q.fadeTo(this.getDefaultTransitionDuration(n),0)}}}if(n){this.buildImage(k,n)}if(!k.image){var m=new Image();m.onload=function(){k.image=this;if(!l&&k.hash==s.data[s.currentImage.index].hash){s.buildImage(k,n)}};m.alt=k.title;m.src=k.slideUrl}this.relocatePreload=true;return this.syncThumbs()},buildImage:function(p,n){var m=this;var k=this.getNextIndex(p.index);var l=this.$imageContainer.append('<span class="image-wrapper current"><a class="advance-link" rel="history" href="#'+this.data[k].hash+'" title="'+p.title+'">&nbsp;</a></span>').find("span.current").css("opacity","0");l.find("a").append(p.image).click(function(q){m.clickHandler(q,this)});var o=0;if(this.$captionContainer){o=this.$captionContainer.append('<span class="image-caption current"></span>').find("span.current").css("opacity","0").append(p.caption)}if(this.$loadingContainer){this.$loadingContainer.hide()}if(this.onTransitionIn){this.onTransitionIn(l,o,n)}else{l.fadeTo(this.getDefaultTransitionDuration(n),1);if(o){o.fadeTo(this.getDefaultTransitionDuration(n),1)
}}if(this.isSlideshowRunning){if(this.slideshowTimeout){clearTimeout(this.slideshowTimeout)}this.slideshowTimeout=setTimeout(function(){m.ssAdvance()},this.delay)}return this},getCurrentPage:function(){return Math.floor(this.currentImage.index/this.numThumbs)},syncThumbs:function(){var l=this.getCurrentPage();if(l!=this.displayedPage){this.updateThumbs()}var k=this.find("ul.thumbs").children();k.filter(".selected").removeClass("selected");k.eq(this.currentImage.index).addClass("selected");return this},updateThumbs:function(k){var l=this;var m=function(){if(k){k()}l.rebuildThumbs();if(l.onPageTransitionIn){l.onPageTransitionIn()}else{l.show()}};if(this.onPageTransitionOut){this.onPageTransitionOut(m)}else{this.hide();m()}return this},rebuildThumbs:function(){var m=this.data.length>this.numThumbs;if(this.enableTopPager){var k=this.find("div.top");if(k.length==0){k=this.prepend('<div class="top pagination"></div>').find("div.top")}else{k.empty()}if(m){this.buildPager(k)}}if(this.enableBottomPager){var o=this.find("div.bottom");if(o.length==0){o=this.append('<div class="bottom pagination"></div>').find("div.bottom")}else{o.empty()}if(m){this.buildPager(o)}}var p=this.getCurrentPage();var q=p*this.numThumbs;var l=q+this.numThumbs-1;if(l>=this.data.length){l=this.data.length-1}var n=this.find("ul.thumbs");n.find("li").each(function(r){var s=b(this);if(r>=q&&r<=l){s.show()}else{s.hide()}});this.displayedPage=p;n.removeClass("noscript");return this},getNumPages:function(){return Math.ceil(this.data.length/this.numThumbs)},buildPager:function(m){var u=this;var l=this.getNumPages();var o=this.getCurrentPage();var s=o*this.numThumbs;var k=this.maxPagesToShow-1;var p=o-Math.floor((this.maxPagesToShow-1)/2)+1;if(p>0){var t=l-p;if(t<k){p=p-(k-t)}}if(p<0){p=0}if(o>0){var n=s-this.numThumbs;m.append('<a rel="history" href="#'+this.data[n].hash+'" title="'+this.prevPageLinkText+'">'+this.prevPageLinkText+"</a>")}if(p>0){this.buildPageLink(m,0,l);if(p>1){m.append('<span class="ellipsis">&hellip;</span>')}k--}while(k>0){this.buildPageLink(m,p,l);k--;p++}if(p<l){var r=l-1;if(p<r){m.append('<span class="ellipsis">&hellip;</span>')}this.buildPageLink(m,r,l)}var q=s+this.numThumbs;if(q<this.data.length){m.append('<a rel="history" href="#'+this.data[q].hash+'" title="'+this.nextPageLinkText+'">'+this.nextPageLinkText+"</a>")}m.find("a").click(function(v){u.clickHandler(v,this)});return this},buildPageLink:function(m,p,n){var l=p+1;var o=this.getCurrentPage();if(p==o){m.append('<span class="current">'+l+"</span>")}else{if(p<n){var k=p*this.numThumbs;m.append('<a rel="history" href="#'+this.data[k].hash+'" title="'+l+'">'+l+"</a>")}}return this}});b.extend(this,c,g);if(this.enableHistory&&!b.historyInit){this.enableHistory=false}if(this.imageContainerSel){this.$imageContainer=b(this.imageContainerSel)}if(this.captionContainerSel){this.$captionContainer=b(this.captionContainerSel)}if(this.loadingContainerSel){this.$loadingContainer=b(this.loadingContainerSel)}this.initializeThumbs();if(this.maxPagesToShow<3){this.maxPagesToShow=3}this.displayedPage=-1;this.currentImage=this.data[0];var e=this;if(this.$loadingContainer){this.$loadingContainer.hide()}if(this.controlsContainerSel){this.$controlsContainer=b(this.controlsContainerSel).empty();if(this.renderSSControls){if(this.autoStart){this.$controlsContainer.append('<div class="ss-controls"><a href="#pause" class="pause" title="'+this.pauseLinkText+'">'+this.pauseLinkText+"</a></div>")}else{this.$controlsContainer.append('<div class="ss-controls"><a href="#play" class="play" title="'+this.playLinkText+'">'+this.playLinkText+"</a></div>")}this.$controlsContainer.find("div.ss-controls a").click(function(k){e.toggleSlideshow();k.preventDefault();return false})}if(this.renderNavControls){this.$controlsContainer.append('<div class="nav-controls"><a class="prev" rel="history" title="'+this.prevLinkText+'">'+this.prevLinkText+'</a><a class="next" rel="history" title="'+this.nextLinkText+'">'+this.nextLinkText+"</a></div>").find("div.nav-controls a").click(function(k){e.clickHandler(k,this)
})}}var f=!this.enableHistory||!location.hash;if(this.enableHistory&&location.hash){var h=b.galleriffic.normalizeHash(location.hash);var j=d[h];if(!j){f=true}}if(f){this.gotoIndex(0,false,true)}if(this.enableKeyboardNavigation){b(document).keydown(function(l){var k=l.charCode?l.charCode:l.keyCode?l.keyCode:0;switch(k){case 32:e.next();l.preventDefault();break;case 33:e.previousPage();l.preventDefault();break;case 34:e.nextPage();l.preventDefault();break;case 35:e.gotoIndex(e.data.length-1);l.preventDefault();break;case 36:e.gotoIndex(0);l.preventDefault();break;case 37:e.previous();l.preventDefault();break;case 39:e.next();l.preventDefault();break}})}if(this.autoStart){this.play()}setTimeout(function(){e.preloadInit()},1000);return this}})(jQuery);