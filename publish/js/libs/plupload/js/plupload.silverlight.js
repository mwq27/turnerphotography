(function(l,i,o,n){var j={},k={};function p(e){var f,a=typeof e,d,b,c;if(a==="string"){f="\bb\tt\nn\ff\rr\"\"''\\\\";return'"'+e.replace(/([\u0080-\uFFFF\x00-\x1f\"])/g,function(h,r){var g=f.indexOf(r);if(g+1){return"\\"+f.charAt(g+1)}h=r.charCodeAt().toString(16);return"\\u"+"0000".substring(h.length)+h})+'"'}if(a=="object"){d=e.length!==n;f="";if(d){for(b=0;b<e.length;b++){if(f){f+=","}f+=p(e[b])}f="["+f+"]"}else{for(c in e){if(e.hasOwnProperty(c)){if(f){f+=","}f+=p(c)+":"+p(e[c])}}f="{"+f+"}"}return f}if(e===n){return"null"}return""+e}function m(a){var x=false,w=null,e=null,v,h,g,y,f,c=0;try{try{e=new ActiveXObject("AgControl.AgControl");if(e.IsVersionSupported(a)){x=true}e=null}catch(b){var d=navigator.plugins["Silverlight Plug-In"];if(d){v=d.description;if(v==="1.0.30226.2"){v="2.0.30226.2"}h=v.split(".");while(h.length>3){h.pop()}while(h.length<4){h.push(0)}g=a.split(".");while(g.length>4){g.pop()}do{y=parseInt(g[c],10);f=parseInt(h[c],10);c++}while(c<g.length&&y===f);if(y<=f&&!isNaN(y)){x=true}}}}catch(z){x=false}return x}o.silverlight={trigger:function(e,c){var a=j[e],b,d;if(a){d=o.toArray(arguments).slice(1);d[0]="Silverlight:"+c;setTimeout(function(){a.trigger.apply(a,d)},0)}}};o.runtimes.Silverlight=o.addRuntime("silverlight",{getFeatures:function(){return{jpgresize:true,pngresize:true,chunks:true,progress:true,multipart:true}},init:function(f,e){var g,a="",h=f.settings.filters,b,c=i.body;if(!m("2.0.31005.0")||(l.opera&&l.opera.buildNumber)){e({success:false});return}k[f.id]=false;j[f.id]=f;g=i.createElement("div");g.id=f.id+"_silverlight_container";o.extend(g.style,{position:"absolute",top:"0px",background:f.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100px",height:"100px",overflow:"hidden",opacity:f.settings.shim_bgcolor||i.documentMode>8?"":0.01});g.className="plupload silverlight";if(f.settings.container){c=i.getElementById(f.settings.container);if(o.getStyle(c,"position")==="static"){c.style.position="relative"}}c.appendChild(g);for(b=0;b<h.length;b++){a+=(a!=""?"|":"")+h[b].title+" | *."+h[b].extensions.replace(/,/g,";*.")}g.innerHTML='<object id="'+f.id+'_silverlight" data="data:application/x-silverlight," type="application/x-silverlight-2" style="outline:none;" width="1024" height="1024"><param name="source" value="'+f.settings.silverlight_xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="id='+f.id+",filter="+a+",multiselect="+f.settings.multi_selection+'"/></object>';function d(){return i.getElementById(f.id+"_silverlight").content.Upload}f.bind("Silverlight:Init",function(){var q,s={};if(k[f.id]){return}k[f.id]=true;f.bind("Silverlight:StartSelectFiles",function(r){q=[]});f.bind("Silverlight:SelectFile",function(A,x,z,y){var r;r=o.guid();s[r]=x;s[x]=r;q.push(new o.File(r,z,y))});f.bind("Silverlight:SelectSuccessful",function(){if(q.length){f.trigger("FilesAdded",q)}});f.bind("Silverlight:UploadChunkError",function(A,x,z,r,y){f.trigger("Error",{code:o.IO_ERROR,message:"IO Error.",details:y,file:A.getFile(s[x])})});f.bind("Silverlight:UploadFileProgress",function(A,r,z,x){var y=A.getFile(s[r]);if(y.status!=o.FAILED){y.size=x;y.loaded=z;A.trigger("UploadProgress",y)}});f.bind("Refresh",function(y){var x,w,r;x=i.getElementById(y.settings.browse_button);if(x){w=o.getPos(x,i.getElementById(y.settings.container));r=o.getSize(x);o.extend(i.getElementById(y.id+"_silverlight_container").style,{top:w.y+"px",left:w.x+"px",width:r.w+"px",height:r.h+"px"})}});f.bind("Silverlight:UploadChunkSuccessful",function(D,A,C,E,r){var z,B=D.getFile(s[A]);z={chunk:C,chunks:E,response:r};D.trigger("ChunkUploaded",B,z);if(B.status!=o.FAILED){d().UploadNextChunk()}if(C==E-1){B.status=o.DONE;D.trigger("FileUploaded",B,{response:r})}});f.bind("Silverlight:UploadSuccessful",function(y,r,x){var w=y.getFile(s[r]);w.status=o.DONE;y.trigger("FileUploaded",w,{response:x})});f.bind("FilesRemoved",function(w,r){var v;
for(v=0;v<r.length;v++){d().RemoveFile(s[r[v].id])}});f.bind("UploadFile",function(y,w){var r=y.settings,x=r.resize||{};d().UploadFile(s[w.id],y.settings.url,p({name:w.target_name||w.name,mime:o.mimeTypes[w.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:r.chunk_size,image_width:x.width,image_height:x.height,image_quality:x.quality||90,multipart:!!r.multipart,multipart_params:r.multipart_params||{},file_data_name:r.file_data_name,headers:r.headers}))});f.bind("Silverlight:MouseEnter",function(w){var v,r;v=i.getElementById(f.settings.browse_button);r=w.settings.browse_button_hover;if(v&&r){o.addClass(v,r)}});f.bind("Silverlight:MouseLeave",function(w){var v,r;v=i.getElementById(f.settings.browse_button);r=w.settings.browse_button_hover;if(v&&r){o.removeClass(v,r)}});f.bind("Silverlight:MouseLeftButtonDown",function(w){var v,r;v=i.getElementById(f.settings.browse_button);r=w.settings.browse_button_active;if(v&&r){o.addClass(v,r);o.addEvent(i.body,"mouseup",function(){o.removeClass(v,r)})}});f.bind("Sliverlight:StartSelectFiles",function(w){var v,r;v=i.getElementById(f.settings.browse_button);r=w.settings.browse_button_active;if(v&&r){o.removeClass(v,r)}});f.bind("Destroy",function(u){var r;o.removeAllEvents(i.body,u.id);delete k[u.id];delete j[u.id];r=i.getElementById(u.id+"_silverlight_container");if(r){c.removeChild(r)}});e({success:true})})}})})(window,document,plupload);