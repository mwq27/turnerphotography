(function(h){var g={};function f(a){return plupload.translate(a)||a}function e(a,b){b.contents().each(function(d,c){c=h(c);if(!c.is(".plupload")){c.remove()}});b.prepend('<div class="plupload_wrapper plupload_scroll"><div id="'+a+'_container" class="plupload_container"><div class="plupload"><div class="plupload_header"><div class="plupload_header_content"><div class="plupload_header_title">'+f("Select files")+'</div><div class="plupload_header_text">'+f("Add files to the upload queue and click the start button.")+'</div></div></div><div class="plupload_content"><div class="plupload_filelist_header"><div class="plupload_file_name">'+f("Filename")+'</div><div class="plupload_file_action">&nbsp;</div><div class="plupload_file_status"><span>'+f("Status")+'</span></div><div class="plupload_file_size">'+f("Size")+'</div><div class="plupload_clearer">&nbsp;</div></div><ul id="'+a+'_filelist" class="plupload_filelist"></ul><div class="plupload_filelist_footer"><div class="plupload_file_name"><div class="plupload_buttons"><a href="#" class="plupload_button plupload_add">'+f("Add files")+'</a><a href="#" class="plupload_button plupload_start">'+f("Start upload")+'</a></div><span class="plupload_upload_status"></span></div><div class="plupload_file_action"></div><div class="plupload_file_status"><span class="plupload_total_status">0%</span></div><div class="plupload_file_size"><span class="plupload_total_file_size">0 b</span></div><div class="plupload_progress"><div class="plupload_progress_container"><div class="plupload_progress_bar"></div></div></div><div class="plupload_clearer">&nbsp;</div></div></div></div></div><input type="hidden" id="'+a+'_count" name="'+a+'_count" value="0" /></div>')}h.fn.pluploadQueue=function(a){if(a){this.each(function(){var c,d,b;d=h(this);b=d.attr("id");if(!b){b=plupload.guid();d.attr("id",b)}c=new plupload.Uploader(h.extend({dragdrop:true,container:b},a));g[b]=c;function l(j){var k;if(j.status==plupload.DONE){k="plupload_done"}if(j.status==plupload.FAILED){k="plupload_failed"}if(j.status==plupload.QUEUED){k="plupload_delete"}if(j.status==plupload.UPLOADING){k="plupload_uploading"}var i=h("#"+j.id).attr("class",k).find("a").css("display","block");if(j.hint){i.attr("title",j.hint)}}function n(){h("span.plupload_total_status",d).html(c.total.percent+"%");h("div.plupload_progress_bar",d).css("width",c.total.percent+"%");h("span.plupload_upload_status",d).text(f("Uploaded %d/%d files").replace(/%d\/%d/,c.total.uploaded+"/"+c.files.length))}function m(){var i=h("ul.plupload_filelist",d).html(""),k=0,j;h.each(c.files,function(q,r){j="";if(r.status==plupload.DONE){if(r.target_name){j+='<input type="hidden" name="'+b+"_"+k+'_tmpname" value="'+plupload.xmlEncode(r.target_name)+'" />'}j+='<input type="hidden" name="'+b+"_"+k+'_name" value="'+plupload.xmlEncode(r.name)+'" />';j+='<input type="hidden" name="'+b+"_"+k+'_status" value="'+(r.status==plupload.DONE?"done":"failed")+'" />';k++;h("#"+b+"_count").val(k)}i.append('<li id="'+r.id+'"><div class="plupload_file_name"><span>'+r.name+'</span></div><div class="plupload_file_action"><a href="#"></a></div><div class="plupload_file_status">'+r.percent+'%</div><div class="plupload_file_size">'+plupload.formatSize(r.size)+'</div><div class="plupload_clearer">&nbsp;</div>'+j+"</li>");l(r);h("#"+r.id+".plupload_delete a").click(function(o){h("#"+r.id).remove();c.removeFile(r);o.preventDefault()})});h("span.plupload_total_file_size",d).html(plupload.formatSize(c.total.size));if(c.total.queued===0){h("span.plupload_add_text",d).text(f("Add files."))}else{h("span.plupload_add_text",d).text(c.total.queued+" files queued.")}h("a.plupload_start",d).toggleClass("plupload_disabled",c.files.length==(c.total.uploaded+c.total.failed));i[0].scrollTop=i[0].scrollHeight;n();if(!c.files.length&&c.features.dragdrop&&c.settings.dragdrop){h("#"+b+"_filelist").append('<li class="plupload_droptext">'+f("Drag files here.")+"</li>")}}c.bind("UploadFile",function(j,i){h("#"+i.id).addClass("plupload_current_file")
});c.bind("Init",function(j,i){e(b,d);if(!a.unique_names&&a.rename){h("#"+b+"_filelist div.plupload_file_name span",d).live("click",function(k){var u=h(k.target),w,t,x,v="";w=j.getFile(u.parents("li")[0].id);x=w.name;t=/^(.+)(\.[^.]+)$/.exec(x);if(t){x=t[1];v=t[2]}u.hide().after('<input type="text" />');u.next().val(x).focus().blur(function(){u.show().next().remove()}).keydown(function(o){var p=h(this);if(o.keyCode==13){o.preventDefault();w.name=p.val()+v;u.text(w.name);p.blur()}})})}h("a.plupload_add",d).attr("id",b+"_browse");j.settings.browse_button=b+"_browse";if(j.features.dragdrop&&j.settings.dragdrop){j.settings.drop_element=b+"_filelist";h("#"+b+"_filelist").append('<li class="plupload_droptext">'+f("Drag files here.")+"</li>")}h("#"+b+"_container").attr("title","Using runtime: "+i.runtime);h("a.plupload_start",d).click(function(k){if(!h(this).hasClass("plupload_disabled")){c.start()}k.preventDefault()});h("a.plupload_stop",d).click(function(k){k.preventDefault();c.stop()});h("a.plupload_start",d).addClass("plupload_disabled")});c.init();c.bind("Error",function(j,k){var i=k.file,p;if(i){p=k.message;if(k.details){p+=" ("+k.details+")"}if(k.code==plupload.FILE_SIZE_ERROR){alert(f("Error: File to large: ")+i.name)}if(k.code==plupload.FILE_EXTENSION_ERROR){alert(f("Error: Invalid file extension: ")+i.name)}i.hint=p;h("#"+i.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",p)}});c.bind("StateChanged",function(){if(c.state===plupload.STARTED){h("li.plupload_delete a,div.plupload_buttons",d).hide();h("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",d).css("display","block");h("span.plupload_upload_status",d).text("Uploaded "+c.total.uploaded+"/"+c.files.length+" files");if(a.multiple_queues){h("span.plupload_total_status,span.plupload_total_file_size",d).show()}}else{m();h("a.plupload_stop,div.plupload_progress",d).hide();h("a.plupload_delete",d).css("display","block")}});c.bind("QueueChanged",m);c.bind("FileUploaded",function(j,i){l(i)});c.bind("UploadProgress",function(j,i){h("#"+i.id+" div.plupload_file_status",d).html(i.percent+"%");l(i);n();if(a.multiple_queues&&c.total.uploaded+c.total.failed==c.files.length){h(".plupload_buttons,.plupload_upload_status",d).css("display","inline");h(".plupload_start",d).addClass("plupload_disabled");h("span.plupload_total_status,span.plupload_total_file_size",d).hide()}});if(a.setup){a.setup(c)}});return this}else{return g[h(this[0]).attr("id")]}}})(jQuery);