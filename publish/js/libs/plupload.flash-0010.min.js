(function(k,h,m,l){var i={},j={};function n(){var c;try{c=navigator.plugins["Shockwave Flash"];c=c.description}catch(a){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(b){c="0.0"}}c=c.match(/\d+/g);return parseFloat(c[0]+"."+c[1])}m.flash={trigger:function(a,c,b){setTimeout(function(){var d=i[a],e,f;if(d){d.trigger("Flash:"+c,b)}},0)}};m.runtimes.Flash=m.addRuntime("flash",{getFeatures:function(){return{jpgresize:true,pngresize:true,maxWidth:8091,maxHeight:8091,chunks:true,progress:true,multipart:true}},init:function(g,b){var c,q,f,a=0,r=h.body;if(n()<10){b({success:false});return}j[g.id]=false;i[g.id]=g;c=h.getElementById(g.settings.browse_button);q=h.createElement("div");q.id=g.id+"_flash_container";m.extend(q.style,{position:"absolute",top:"0px",background:g.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"});q.className="plupload flash";if(g.settings.container){r=h.getElementById(g.settings.container);if(m.getStyle(r,"position")==="static"){r.style.position="relative"}}r.appendChild(q);f="id="+escape(g.id);q.innerHTML='<object id="'+g.id+'_flash" width="100%" height="100%" style="outline:0" type="application/x-shockwave-flash" data="'+g.settings.flash_swf_url+'"><param name="movie" value="'+g.settings.flash_swf_url+'" /><param name="flashvars" value="'+f+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';function d(){return h.getElementById(g.id+"_flash")}function e(){if(a++>5000){b({success:false});return}if(!j[g.id]){setTimeout(e,1)}}e();c=q=null;g.bind("Flash:Init",function(){var o={},p;d().setFileFilters(g.settings.filters,g.settings.multi_selection);if(j[g.id]){return}j[g.id]=true;g.bind("UploadFile",function(z,x){var w=z.settings,y=g.settings.resize||{};d().uploadFile(o[x.id],w.url,{name:x.target_name||x.name,mime:m.mimeTypes[x.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:w.chunk_size,width:y.width,height:y.height,quality:y.quality,multipart:w.multipart,multipart_params:w.multipart_params||{},file_data_name:w.file_data_name,format:/\.(jpg|jpeg)$/i.test(x.name)?"jpg":"png",headers:w.headers,urlstream_upload:w.urlstream_upload})});g.bind("Flash:UploadProcess",function(w,x){var v=w.getFile(o[x.id]);if(v.status!=m.FAILED){v.loaded=x.loaded;v.size=x.size;w.trigger("UploadProgress",v)}});g.bind("Flash:UploadChunkComplete",function(z,x){var w,y=z.getFile(o[x.id]);w={chunk:x.chunk,chunks:x.chunks,response:x.text};z.trigger("ChunkUploaded",y,w);if(y.status!=m.FAILED){d().uploadNextChunk()}if(x.chunk==x.chunks-1){y.status=m.DONE;z.trigger("FileUploaded",y,{response:x.text})}});g.bind("Flash:SelectFiles",function(D,A){var B,C,z=[],y;for(C=0;C<A.length;C++){B=A[C];y=m.guid();o[y]=B.id;o[B.id]=y;z.push(new m.File(y,B.name,B.size))}if(z.length){g.trigger("FilesAdded",z)}});g.bind("Flash:SecurityError",function(v,u){g.trigger("Error",{code:m.SECURITY_ERROR,message:m.translate("Security error."),details:u.message,file:g.getFile(o[u.id])})});g.bind("Flash:GenericError",function(v,u){g.trigger("Error",{code:m.GENERIC_ERROR,message:m.translate("Generic error."),details:u.message,file:g.getFile(o[u.id])})});g.bind("Flash:IOError",function(v,u){g.trigger("Error",{code:m.IO_ERROR,message:m.translate("IO error."),details:u.message,file:g.getFile(o[u.id])})});g.bind("Flash:ImageError",function(v,u){g.trigger("Error",{code:parseInt(u.code,10),message:m.translate("Image error."),file:g.getFile(o[u.id])})});g.bind("Flash:StageEvent:rollOver",function(x){var w,v;w=h.getElementById(g.settings.browse_button);v=x.settings.browse_button_hover;if(w&&v){m.addClass(w,v)}});g.bind("Flash:StageEvent:rollOut",function(x){var w,v;w=h.getElementById(g.settings.browse_button);v=x.settings.browse_button_hover;if(w&&v){m.removeClass(w,v)}});g.bind("Flash:StageEvent:mouseDown",function(x){var w,v;w=h.getElementById(g.settings.browse_button);v=x.settings.browse_button_active;if(w&&v){m.addClass(w,v);m.addEvent(h.body,"mouseup",function(){m.removeClass(w,v)},x.id)}});g.bind("Flash:StageEvent:mouseUp",function(x){var w,v;w=h.getElementById(g.settings.browse_button);v=x.settings.browse_button_active;if(w&&v){m.removeClass(w,v)}});g.bind("QueueChanged",function(t){g.refresh()});g.bind("FilesRemoved",function(x,v){var w;for(w=0;w<v.length;w++){d().removeFile(o[v[w].id])}});g.bind("StateChanged",function(t){g.refresh()});g.bind("Refresh",function(z){var y,x,w;d().setFileFilters(g.settings.filters,g.settings.multi_selection);y=h.getElementById(z.settings.browse_button);if(y){x=m.getPos(y,h.getElementById(z.settings.container));w=m.getSize(y);m.extend(h.getElementById(z.id+"_flash_container").style,{top:x.y+"px",left:x.x+"px",width:w.w+"px",height:w.h+"px"})}});g.bind("Destroy",function(v){var u;m.removeAllEvents(h.body,v.id);delete j[v.id];delete i[v.id];u=h.getElementById(v.id+"_flash_container");if(u){r.removeChild(u)}});b({success:true})})}})})(window,document,plupload);